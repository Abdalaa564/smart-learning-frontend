<div class="container py-4">
  <button class="btn btn-outline-secondary mb-3" (click)="goBack()">
    <i class="fa fa-arrow-left me-2"></i> Back to Courses
  </button>

  <!-- Skeleton -->
  <div *ngIf="isLoading">
    <app-skeleton-card
      [showImage]="true"
      [lines]="4"
      [showActions]="true"
      imageHeight="260px"
      animation="wave"
    ></app-skeleton-card>
  </div>

  <!-- Content -->
  <div class="row" *ngIf="!isLoading && course">
    <div class="col-md-5 mb-3">
      <div class="image-wrapper shadow-sm">
        <img [src]="getCourseImage()" [alt]="course.crs_Name" class="img-fluid rounded" />
      </div>
    </div>

    <div class="col-md-7">
      <h2 class="fw-bold mb-3">{{ course.crs_Name }}</h2>
      <p class="text-muted">{{ course.crs_Description }}</p>

      <div class="mb-3">
        <span class="badge bg-success me-2">
          <i class="fa fa-money-bill me-1"></i>
          {{ course.price }} EGP
        </span>
      </div>

      <div class="mt-4">
        <h5>What you will learn</h5>
        <ul class="list-unstyled">
          <li><i class="fa fa-check text-success me-2"></i> Topic 1</li>
          <li><i class="fa fa-check text-success me-2"></i> Topic 2</li>
          <li><i class="fa fa-check text-success me-2"></i> Topic 3</li>
        </ul>
      </div>

      <div class="mt-4 d-flex gap-2">
        <button class="btn btn-primary">
          <i class="fa fa-graduation-cap me-2"></i> Enroll Now
        </button>
        <button class="btn btn-outline-primary" [routerLink]="['/Courses', course.crs_Id, 'units']">
          <i class="fa fa-book-open me-2"></i> View Units
        </button>
      </div>

      <!-- Rating Section -->
      <div class="add-rating mt-4" *ngIf="course">
        <h5>Rate {{ course.crs_Name }}</h5>

        <div class="stars mb-2">
          <span *ngFor="let star of [1,2,3,4,5]; let i = index"
                (click)="!hasRated && setRating(i+1)"
                (mouseenter)="!hasRated && hoverRating(i+1)"
                (mouseleave)="!hasRated && hoverRating(0)"
                [class.filled]="i < (hoveredRating > 0 ? hoveredRating : ratingValue)"
                [class.disabled]="hasRated">
            ★
          </span>
        </div>

        <textarea [(ngModel)]="feedback"
                  class="form-control mb-2"
                  rows="3"
                  placeholder="Write your feedback"
                  [disabled]="hasRated"></textarea>

        <button class="btn btn-accent" (click)="submitRating()"
                [disabled]="hasRated || ratingValue === 0">
          Submit Rating
        </button>

        <p *ngIf="hasRated" class="text-success mt-2">
          You already rated this course. ✅
        </p>
      </div>
    </div>
  </div>
</div>
