<section class="meeting-container">

  <!-- Loader -->
  <div *ngIf="callingState !== 'joined'" class="loader-container">
    <app-loader></app-loader>
  </div>

  <!-- Main Meeting UI -->
  <div *ngIf="callingState === 'joined'" class="meeting-content">

    <div class="video-wrapper">
      <!-- Call Layout -->
      <ng-container [ngSwitch]="layout">
        
        <!-- Grid Layout -->
        <div *ngSwitchCase="'grid'">
          <app-paginated-grid-layout></app-paginated-grid-layout>
        </div>

        <!-- Speaker Right -->
        <div *ngSwitchCase="'speaker-right'">
          <app-speaker-layout position="left"></app-speaker-layout>
        </div>

        <!-- Speaker Left -->
        <div *ngSwitchDefault>
          <app-speaker-layout position="right"></app-speaker-layout>
        </div>

      </ng-container>
    </div>

    <!-- Participants list -->
    <div
      class="participants"
      [class.show-block]="showParticipants"
    >
      <app-call-participants-list
        (close)="toggleParticipants()">
      </app-call-participants-list>
    </div>

  </div>

  <!-- Bottom Controls -->
  <div class="controls">
    <app-call-controls (leave)="leaveCall()"></app-call-controls>

    <!-- Layout Dropdown -->
    <div class="dropdown">
      <button class="dropdown-btn">Layout</button>
      <div class="dropdown-menu">
        <div (click)="changeLayout('grid')">Grid</div>
        <div (click)="changeLayout('speaker-left')">Speaker Left</div>
        <div (click)="changeLayout('speaker-right')">Speaker Right</div>
      </div>
    </div>

    <app-call-stats-button></app-call-stats-button>

    <button class="control-btn" (click)="toggleParticipants()">
      <i class="fas fa-user-friends me-2"></i>
    </button>

    <app-end-call-button></app-end-call-button>
  </div>

</section>
